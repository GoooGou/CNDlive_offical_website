---
// src/pages/products/[id]/index.astro
import { getCollection } from 'astro:content';

// ✅ 修正 1：路径通常是 layouts，除非你真的把它放在 components 里了
import ProductLayout from '@/components/products/ProductLayout.astro';

import Cover from '@/components/common/Cover.astro';
import MDXContent from '@/components/mdx/MDXContent.astro';
import ArticleBody from '@/components/mdx/ArticleBody.astro';

// ❌ 删除：不需要在这里引入 ProductTabs，因为 ProductLayout 内部已经包含了
// import ProductTabs from '@/components/products/ProductTabs.astro';

// 生成所有产品的路径
export async function getStaticPaths() {
  const posts = await getCollection('products');
  return posts.map((post) => ({
    params: { id: post.id },
    props: { post },
  }));
}

const { post } = Astro.props;
const basePath = '/products';
---

<ProductLayout
  post={post}
  basePath={basePath}
  parentTitle="Products"
  activeTabId="overview"
>
  {/* 1. 封面图区域 */}
  {/* ✅ 修正 2：使用语义化变量 bg-surface-card 适配黑白主题 */}
  <div
    class="border-surface-border bg-surface-card mb-10 overflow-hidden rounded-2xl border shadow-2xl"
  >
    <Cover
      src={post.data.cover}
      alt={post.data.title}
      title={post.data.title}
    />
  </div>

  {/* 2. 咨询按钮 */}
  <div class="mb-16 flex justify-center">
    <a
      href="/contact"
      class="bg-primary hover:bg-primary-dark shadow-primary/20 transform rounded-full px-8 py-3 text-lg font-bold text-white shadow-lg transition-all hover:-translate-y-1"
    >
      Enquire Now
    </a>
  </div>

  {/* 3. 产品营销文案 (MDX) */}
  {/* ✅ 修正 3：添加 prose 类，否则 Markdown 内容没有排版样式 */}
   <ArticleBody post={post} />
  
 

</ProductLayout>
