---
// src/pages/products/[id]/specs.astro
import { getCollection } from 'astro:content';
import ProductLayout from '@/components/products/ProductLayout.astro';
import { marked } from 'marked'; // ğŸ”¥ 1. å¼•å…¥è§£æå™¨

export async function getStaticPaths() {
  const posts = await getCollection('products');
  return posts.map((post) => ({
    params: { id: post.id },
    props: { post },
  }));
}

const { post } = Astro.props;
const basePath = '/products';
const specs = post.data.specs || [];
---

<ProductLayout
  post={post}
  basePath={basePath}
  parentTitle="Products"
  activeTabId="tech-specs"
>
  <div
    class="animate-in fade-in slide-in-from-bottom-4 mx-auto max-w-4xl py-8 duration-500"
  >
    <h2 class="mb-8 text-center text-3xl font-bold text-white">
      Technical Specifications
    </h2>

    {
      specs.length > 0 ? (
        <div class="overflow-hidden rounded-xl border border-white/10 bg-zinc-900 shadow-2xl">
          <table class="w-full border-collapse text-left">
            <tbody>
              {specs.map((item, index) => (
                <tr
                  class={`border-b border-white/10 last:border-0 ${index % 2 === 0 ? 'bg-white/2' : 'bg-transparent'}`}
                >
                  {/* å·¦ä¾§ Label */}
                  <td class="w-1/4 border-r border-white/10 p-6 align-top text-sm font-bold tracking-wide text-zinc-400 uppercase">
                    {item.label}
                  </td>

                  {/* å³ä¾§ Value (Markdown æ¸²æŸ“åŒº) */}
                  <td class="p-6 align-top text-zinc-200">
                    {/* ğŸ”¥ æ ¸å¿ƒä¿®æ”¹ï¼š 
                     1. marked.parse(item.value) æŠŠ markdown è½¬æˆ html
                     2. set:html å°†å…¶æ’å…¥
                     3. prose ç±»åç”¨äºè¿˜åŸåˆ—è¡¨æ ·å¼ (ul, li, strong)
                  */}
                    <div
                      class="prose prose-invert prose-sm prose-ul:list-disc prose-ul:pl-4 prose-ul:my-2 prose-li:my-1 prose-li:text-zinc-300 prose-strong:text-white prose-strong:font-bold prose-p:my-2 prose-p:leading-relaxed max-w-none"
                      set:html={marked.parse(item.value)}
                    />
                  </td>
                </tr>
              ))}
            </tbody>
          </table>
        </div>
      ) : (
        <p class="py-12 text-center text-zinc-500">
          No specifications available.
        </p>
      )
    }
  </div>
</ProductLayout>
