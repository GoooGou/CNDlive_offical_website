---
import { Image } from 'astro:assets';

interface Props {
  src?: any;
  alt: string;
  title?: string;
  className?: string;
}

const { src, alt, title = 'CNDLive', className = '' } = Astro.props;

// æå–é¦–å­—æ¯ç”¨äºå±•ç¤º (ä¾‹å¦‚ "Nintendo" -> "N")
const initial = title.charAt(0).toUpperCase();

// ğŸ¨ 1. äº®è‰²æ¨¡å¼ (æ›´æ¢¦å¹»ã€æŸ”å’Œçš„ä¸‰è‰²æ¸å˜)
const lightGradients = [
  'from-blue-100 via-indigo-50 to-purple-100',
  'from-emerald-50 via-teal-100 to-cyan-100',
  'from-orange-50 via-amber-50 to-yellow-100',
  'from-rose-50 via-pink-50 to-fuchsia-100',
  'from-slate-100 via-zinc-100 to-neutral-200',
];

// ğŸ¨ 2. æ·±è‰²æ¨¡å¼ (æ›´æ·±é‚ƒã€æœ‰å…‰æ³½æ„Ÿçš„æ·±è‰²æ¸å˜)
const darkGradients = [
  'from-blue-900 via-slate-900 to-black',
  'from-emerald-900 via-teal-950 to-black',
  'from-orange-900 via-red-950 to-black',
  'from-purple-900 via-indigo-950 to-black',
  'from-zinc-800 via-neutral-900 to-black',
];

// ğŸ² ç¡®å®šæ€§ç®—æ³•
const getGradientClass = (str: string) => {
  const index = str ? str.length % lightGradients.length : 0;
  // ç»„åˆç±»åï¼šbg-gradient-to-br [äº®è‰²] dark:[æ·±è‰²]
  return `bg-gradient-to-br ${lightGradients[index]} dark:${darkGradients[index]}`;
};

const gradientClass = getGradientClass(title);
---

<div
  class={`
  relative w-full h-full overflow-hidden 
  /* åŸºç¡€èƒŒæ™¯ï¼Œé˜²æ­¢é—ªçƒ */
  bg-zinc-100 dark:bg-zinc-900
  ${className}
`}
>
  {
    src ? (
      // âœ… æœ‰å›¾æ¨¡å¼
      <Image
        src={src}
        alt={alt}
        class="h-full w-full object-cover transition-transform duration-700 group-hover:scale-105"
      />
    ) : (
      // ğŸ¨ æ— å›¾å…œåº• (é«˜çº§è´¨æ„Ÿç‰ˆ)
      <div
        class={`relative h-full w-full transition-transform duration-700 group-hover:scale-105 ${gradientClass} `}
      >
        {/* âœ¨ 1. å™ªç‚¹çº¹ç†å±‚ (å…³é”®ï¼šè®©é¢œè‰²çœ‹èµ·æ¥æœ‰æè´¨æ„Ÿ) */}
        <div
          class="absolute inset-0 opacity-20 mix-blend-soft-light"
          style="background-image: url('data:image/svg+xml,%3Csvg viewBox=%220 0 200 200%22 xmlns=%22http://www.w3.org/2000/svg%22%3E%3Cfilter id=%22noiseFilter%22%3E%3CfeTurbulence type=%22fractalNoise%22 baseFrequency=%220.65%22 numOctaves=%223%22 stitchTiles=%22stitch%22/%3E%3C/filter%3E%3Crect width=%22100%25%22 height=%22100%25%22 filter=%22url(%23noiseFilter)%22/%3E%3C/svg%3E');"
        ></div>

        {/* âœ¨ 2. å†…éƒ¨å…‰æ–‘ (å¢åŠ ç©ºé—´æ„Ÿ) */}
        <div class="pointer-events-none absolute -top-1/2 -right-1/2 h-full w-full rounded-full bg-white/40 blur-3xl dark:bg-white/5" />
        <div class="pointer-events-none absolute -bottom-1/2 -left-1/2 h-full w-full rounded-full bg-black/5 blur-3xl dark:bg-black/20" />

        {/* âœ¨ 3. ä¸­å¿ƒå¤§å­—æ¯ (Monogram) */}
        <div class="absolute inset-0 flex items-center justify-center">
          <span class="/* äº®è‰²æ¨¡å¼ï¼šé¢œè‰²æ·±ä¸€ç‚¹ï¼Œå åŠ æ¨¡å¼ */ /* æ·±è‰²æ¨¡å¼ï¼šé¢œè‰²äº®ä¸€ç‚¹ï¼Œå‘å…‰æ„Ÿ */ text-6xl font-black text-black/5 mix-blend-overlay transition-colors duration-300 select-none md:text-7xl dark:text-white/10">
            {initial}
          </span>
        </div>
      </div>
    )
  }

  {/* âœ¨ 4. ç»Ÿä¸€å†…è¾¹æ¡† (ç²¾è‡´æ„Ÿ) */}
  <div
    class="pointer-events-none absolute inset-0 rounded-[inherit] ring-1 ring-black/5 ring-inset dark:ring-white/10"
  >
  </div>
</div>
