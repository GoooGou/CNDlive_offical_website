---
import { Image } from 'astro:assets';

interface Props {
  src?: any;          // å›¾ç‰‡æº (æ”¯æŒ Astro ä¼˜åŒ–å›¾ç‰‡å¯¹è±¡)
  alt: string;        // å›¾ç‰‡æè¿° (SEO å¿…é¡»)
  title?: string;     // æ–‡å­—ç§å­ (ç”¨äºç”Ÿæˆå›ºå®šçš„èƒŒæ™¯è‰²)
  className?: string; // å…è®¸å¤–éƒ¨ä¼ å…¥æ ·å¼
}

const { 
  src, 
  alt, 
  title = "CNDLive", // é»˜è®¤å…œåº•æ–‡å­—
  className = "" 
} = Astro.props;

// ğŸ¨ é€šç”¨æ·±è‰²æ¸å˜æ±  (Tech Dark Mode)
// åŒ…å«ï¼šæ·±ç´«ã€æ·±è“ã€è“ç»¿ã€æ·±çº¢ã€é»‘ç°
const gradients = [
  "bg-gradient-to-br from-indigo-900 to-slate-950",
  "bg-gradient-to-br from-blue-900 to-zinc-950",
  "bg-gradient-to-br from-teal-900 to-emerald-950",
  "bg-gradient-to-br from-rose-900 to-stone-950",
  "bg-gradient-to-br from-violet-900 to-fuchsia-950",
  "bg-gradient-to-br from-zinc-800 to-neutral-950",
  "bg-gradient-to-br from-cyan-900 to-sky-950",
];

// ğŸ² ç¡®å®šæ€§ç®—æ³•ï¼šåªè¦ title ä¸€æ ·ï¼Œç®—å‡ºæ¥çš„é¢œè‰²æ°¸è¿œä¸€æ ·
// é˜²æ­¢é¡µé¢åˆ·æ–°æˆ–é‡æ–°æ„å»ºæ—¶é¢œè‰²ä¹±è·³
const getGradient = (str: string) => {
  if (!str) return gradients[0];
  return gradients[str.length % gradients.length];
};

const fallbackBg = getGradient(title);
---

<div class={`relative w-full h-full overflow-hidden bg-zinc-900 ${!src ? fallbackBg : ''} ${className}`}>
  
  {src ? (
    // âœ… æ¨¡å¼ A: æ­£å¸¸æ˜¾ç¤ºå›¾ç‰‡
    <Image 
      src={src} 
      alt={alt} 
      class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-105 not-prose"
    />
  ) : (
    // ğŸ¨ æ¨¡å¼ B: æ— å›¾å…œåº• (æ˜¾ç¤ºæ¸å˜è‰² + æ ‡é¢˜æ°´å°)
    <div class="w-full h-full flex items-center justify-center p-6 group-hover:scale-105 transition-transform duration-700">
      {/* æ ‡é¢˜æ°´å°ï¼šé™åˆ¶è¡Œæ•°ï¼Œè¶…å¤§å­—å·ï¼Œä½é€æ˜åº¦ */}
      <span class="text-white/10 font-black text-3xl md:text-4xl uppercase tracking-widest text-center select-none leading-none line-clamp-3 break-words">
        {title}
      </span>
    </div>
  )}

  {/* âœ¨ è´¨æ„Ÿå¢å¼ºï¼šç»™æ‰€æœ‰å°é¢åŠ ä¸€ä¸ªæç»†çš„åŠé€æ˜å†…è¾¹æ¡†ï¼Œæå‡ç²¾è‡´åº¦ */}
  <div class="absolute inset-0 ring-1 ring-inset ring-white/10 pointer-events-none rounded-[inherit]"></div>

</div>