---
const ACCESS_KEY = '301b67db-1fd0-4c34-aabc-00861ab2e358';
---

{
  /* 1. å®¹å™¨èƒŒæ™¯ï¼šbg-surface-card (è‡ªåŠ¨å˜ç™½/å˜æ·±ç°)
  2. è¾¹æ¡†ï¼šborder-surface-border (è‡ªåŠ¨å˜æµ…ç°/æ·±ç°)
*/
}
<div
  class="bg-surface-card border-surface-border mx-auto w-full max-w-2xl rounded-2xl border p-8 shadow-xl"
>
  <form id="contact-form" class="space-y-6">
    {/* Web3Forms éšè—å­—æ®µ */}
    <input type="hidden" name="access_key" value={ACCESS_KEY} />
    <input type="hidden" name="subject" value="New Contact Message" />
    <input
      type="checkbox"
      name="botcheck"
      class="hidden"
      style="display: none;"
    />

    {/* ç¬¬ä¸€è¡Œï¼šName & Email */}
    <div class="grid grid-cols-1 gap-6 md:grid-cols-2">
      <div class="space-y-2">
        <label for="name" class="text-text-muted text-sm font-medium"
          >Name *</label
        >
        <input
          type="text"
          name="name"
          required
          placeholder="Your Name"
          class="bg-surface-muted border-surface-border text-text-main placeholder-text-muted/60 focus:ring-primary focus:border-primary w-full rounded-lg border px-4 py-3 transition outline-none focus:ring-1"
        />
      </div>
      <div class="space-y-2">
        <label for="email" class="text-text-muted text-sm font-medium"
          >Email *</label
        >
        <input
          type="email"
          name="email"
          required
          placeholder="email@example.com"
          class="bg-surface-muted border-surface-border text-text-main placeholder-text-muted/60 focus:ring-primary focus:border-primary w-full rounded-lg border px-4 py-3 transition outline-none focus:ring-1"
        />
      </div>
    </div>

    {/* ç¬¬äºŒè¡Œï¼šCountry & Phone */}
    <div class="grid grid-cols-1 gap-6 md:grid-cols-2">
      <div class="space-y-2">
        <label for="country" class="text-text-muted text-sm font-medium"
          >Country or Region *</label
        >
        <input
          type="text"
          name="country"
          required
          placeholder="Country or Region"
          class="bg-surface-muted border-surface-border text-text-main placeholder-text-muted/60 focus:ring-primary focus:border-primary w-full rounded-lg border px-4 py-3 transition outline-none focus:ring-1"
        />
      </div>
      <div class="space-y-2">
        <label for="phone" class="text-text-muted text-sm font-medium"
          >Phone Number</label
        >
        <input
          type="text"
          name="phone"
          placeholder="phone"
          class="bg-surface-muted border-surface-border text-text-main placeholder-text-muted/60 focus:ring-primary focus:border-primary w-full rounded-lg border px-4 py-3 transition outline-none focus:ring-1"
        />
      </div>
    </div>

    {/* æ¶ˆæ¯æ¡† */}
    <div class="space-y-2">
      <label for="message" class="text-text-muted text-sm font-medium"
        >Message</label
      >
      <textarea
        name="message"
        rows="5"
        placeholder="How can we help you?"
        class="bg-surface-muted border-surface-border text-text-main placeholder-text-muted/60 focus:ring-primary focus:border-primary w-full resize-none rounded-lg border px-4 py-3 transition outline-none focus:ring-1"
      ></textarea>
    </div>

    {
      /* æäº¤æŒ‰é’® 
        æ³¨æ„ï¼štext-white ä¿æŒä¸å˜ï¼Œå› ä¸ºèƒŒæ™¯æ˜¯ primary çº¢è‰²ï¼Œ
        æ— è®ºæ·±æµ…æ¨¡å¼ï¼Œçº¢è‰²èƒŒæ™¯ä¸Šéƒ½åº”è¯¥ç”¨ç™½è‰²æ–‡å­—ã€‚
    */
    }
    <button
      type="submit"
      id="submit-btn"
      class="bg-primary hover:bg-primary/90 group flex items-center gap-2 rounded-full px-8 py-4 font-bold text-white transition-all"
    >
      <span id="btn-text">Send Message</span>
      <svg
        id="btn-icon"
        xmlns="http://www.w3.org/2000/svg"
        width="20"
        height="20"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        class="transition-transform group-hover:translate-x-1"
        ><line x1="22" y1="2" x2="11" y2="13"></line><polygon
          points="22 2 15 22 11 13 2 9 22 2"></polygon></svg
      >
    </button>

    {/* ç»“æœåŒºåŸŸ */}
    <div
      id="result"
      class="hidden rounded-lg p-4 text-center text-sm font-medium transition-all duration-300"
    >
    </div>
  </form>
</div>

<script is:inline>
  const form = document.getElementById('contact-form');
  const result = document.getElementById('result');
  const btn = document.getElementById('submit-btn');
  const btnText = document.getElementById('btn-text');
  const btnIcon = document.getElementById('btn-icon');

  // å®šä¹‰çŠ¶æ€æ ·å¼ (åŒæ—¶åŒ…å«æµ…è‰²å’Œæ·±è‰²æ ·å¼)
  const successClasses = [
    'bg-green-50',
    'text-green-700',
    'border-green-200', // Light mode
    'dark:bg-green-900/30',
    'dark:text-green-400',
    'dark:border-green-500/30',
    'border', // Dark mode
  ];

  const errorClasses = [
    'bg-red-50',
    'text-red-700',
    'border-red-200', // Light mode
    'dark:bg-red-900/30',
    'dark:text-red-400',
    'dark:border-red-500/30',
    'border', // Dark mode
  ];

  form.addEventListener('submit', function (e) {
    e.preventDefault();

    // æ”¹å˜æŒ‰é’®çŠ¶æ€
    const originalText = btnText.innerText;
    btnText.innerText = 'Sending...';
    btnIcon.classList.add('hidden');
    btn.disabled = true;
    btn.classList.add('opacity-50', 'cursor-not-allowed');

    const formData = new FormData(form);
    const object = Object.fromEntries(formData);
    const json = JSON.stringify(object);

    result.classList.add('hidden');

    fetch('https://api.web3forms.com/submit', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        Accept: 'application/json',
      },
      body: json,
    })
      .then(async (response) => {
        let json = await response.json();

        // å…ˆç§»é™¤æ‰€æœ‰å¯èƒ½å­˜åœ¨çš„é¢œè‰²ç±»
        result.classList.remove('hidden', ...successClasses, ...errorClasses);

        if (response.status == 200) {
          // æˆåŠŸ
          result.innerHTML =
            "ğŸ‰ Message sent successfully! We'll get back to you soon.";
          result.classList.add(...successClasses);
          form.reset();
        } else {
          // å¤±è´¥
          console.log(response);
          result.innerHTML =
            json.message || 'Something went wrong. Please try again.';
          result.classList.add(...errorClasses);
        }
      })
      .catch((error) => {
        console.log(error);
        result.innerHTML = 'Network error. Please try again.';
        result.classList.remove('hidden', ...successClasses);
        result.classList.add(...errorClasses);
      })
      .then(function () {
        btnText.innerText = originalText;
        btnIcon.classList.remove('hidden');
        btn.disabled = false;
        btn.classList.remove('opacity-50', 'cursor-not-allowed');

        setTimeout(() => {
          result.classList.add('hidden');
        }, 5000);
      });
  });
</script>
