---
const ACCESS_KEY = "aa01d43d-5d5c-42b9-99ac-47adb38b6b5d"; // ä½ çš„ Key
---

<div class="w-full max-w-2xl mx-auto bg-[#0a0a0a] border border-white/10 rounded-2xl p-8 shadow-2xl">
  <h3 class="text-3xl font-bold text-white mb-8 flex items-center gap-2">
    Send us a message <span class="text-primary">â†’</span>
  </h3>
  
  <form id="contact-form" class="space-y-6">
    
    {/* Web3Forms éšè—å­—æ®µ */}
    <input type="hidden" name="access_key" value={ACCESS_KEY} />
    <input type="hidden" name="subject" value="New Contact Message" />
    <input type="checkbox" name="botcheck" class="hidden" style="display: none;">

    {/* ç¬¬ä¸€è¡Œï¼šName & Email */}
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
      <div class="space-y-2">
        <label for="name" class="text-sm font-medium text-zinc-400">Name *</label>
        <input 
          type="text" 
          name="name" 
          required
          placeholder="Your Name"
          class="w-full bg-zinc-900 border border-zinc-800 rounded-lg px-4 py-3 text-white focus:ring-1 focus:ring-primary focus:border-primary outline-none transition placeholder-zinc-600"
        />
      </div>
      <div class="space-y-2">
        <label for="email" class="text-sm font-medium text-zinc-400">Email *</label>
        <input 
          type="email" 
          name="email" 
          required
          placeholder="email@example.com"
          class="w-full bg-zinc-900 border border-zinc-800 rounded-lg px-4 py-3 text-white focus:ring-1 focus:ring-primary focus:border-primary outline-none transition placeholder-zinc-600"
        />
      </div>
    </div>

    {/* ç¬¬äºŒè¡Œï¼šCountry & Phone */}
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
      <div class="space-y-2">
        <label for="country" class="text-sm font-medium text-zinc-400">Country or Region *</label>
        <input 
          type="text" 
          name="country" 
          required
          placeholder="China"
          class="w-full bg-zinc-900 border border-zinc-800 rounded-lg px-4 py-3 text-white focus:ring-1 focus:ring-primary focus:border-primary outline-none transition placeholder-zinc-600"
        />
      </div>
      <div class="space-y-2">
        <label for="phone" class="text-sm font-medium text-zinc-400">Phone Number</label>
        <input 
          type="text" 
          name="phone" 
          placeholder="+86 ..."
          class="w-full bg-zinc-900 border border-zinc-800 rounded-lg px-4 py-3 text-white focus:ring-1 focus:ring-primary focus:border-primary outline-none transition placeholder-zinc-600"
        />
      </div>
    </div>

    {/* æ¶ˆæ¯æ¡† */}
    <div class="space-y-2">
      <label for="message" class="text-sm font-medium text-zinc-400">Message</label>
      <textarea 
        name="message" 
        rows="5" 
        placeholder="How can we help you?"
        class="w-full bg-zinc-900 border border-zinc-800 rounded-lg px-4 py-3 text-white focus:ring-1 focus:ring-primary focus:border-primary outline-none transition resize-none placeholder-zinc-600"
      ></textarea>
    </div>

    {/* æäº¤æŒ‰é’® */}
    <button 
      type="submit" 
      id="submit-btn"
      class="bg-primary hover:bg-primary/90 text-white font-bold py-4 px-8 rounded-full transition-all flex items-center gap-2 group"
    >
      <span id="btn-text">Send Message</span>
      {/* è¿™æ˜¯ä¸€ä¸ªç®€å•çš„å‘é€å›¾æ ‡ SVG */}
      <svg id="btn-icon" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="transition-transform group-hover:translate-x-1"><line x1="22" y1="2" x2="11" y2="13"></line><polygon points="22 2 15 22 11 13 2 9 22 2"></polygon></svg>
    </button>

    {/* ğŸ”¥ğŸ”¥ğŸ”¥ å…³é”®ï¼šç»“æœåé¦ˆåŒºåŸŸ (é»˜è®¤æ˜¯éšè—çš„) ğŸ”¥ğŸ”¥ğŸ”¥ */}
    <div id="result" class="hidden text-center p-4 rounded-lg text-sm font-medium transition-all duration-300"></div>

  </form>
</div>

<script is:inline>
  const form = document.getElementById('contact-form');
  const result = document.getElementById('result');
  const btn = document.getElementById('submit-btn');
  const btnText = document.getElementById('btn-text');
  const btnIcon = document.getElementById('btn-icon');

  form.addEventListener('submit', function(e) {
    e.preventDefault(); // 1. é˜»æ­¢é»˜è®¤åˆ·æ–°
    
    // 2. æ”¹å˜æŒ‰é’®çŠ¶æ€ (è®©ç”¨æˆ·çŸ¥é“åœ¨å‘é€)
    const originalText = btnText.innerText;
    btnText.innerText = "Sending...";
    btnIcon.classList.add('hidden'); // éšè—å›¾æ ‡
    btn.disabled = true;
    btn.classList.add('opacity-50', 'cursor-not-allowed');

    // æ”¶é›†æ•°æ®
    const formData = new FormData(form);
    const object = Object.fromEntries(formData);
    const json = JSON.stringify(object);

    // éšè—ä¹‹å‰çš„æ¶ˆæ¯
    result.classList.add('hidden');

    // 3. å‘é€è¯·æ±‚
    fetch('https://api.web3forms.com/submit', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
            'Accept': 'application/json'
        },
        body: json
    })
    .then(async (response) => {
        let json = await response.json();
        if (response.status == 200) {
            // âœ… 4. æˆåŠŸï¼šæ˜¾ç¤ºç»¿è‰²æ¶ˆæ¯
            result.innerHTML = "ğŸ‰ Message sent successfully! We'll get back to you soon.";
            result.classList.remove('hidden', 'bg-red-900/30', 'text-red-400');
            result.classList.add('bg-green-900/30', 'text-green-400', 'border', 'border-green-500/30');
            form.reset(); // æ¸…ç©ºè¡¨å•
        } else {
            // âŒ 5. å¤±è´¥ï¼šæ˜¾ç¤ºçº¢è‰²æ¶ˆæ¯
            console.log(response);
            result.innerHTML = json.message || "Something went wrong. Please try again.";
            result.classList.remove('hidden', 'bg-green-900/30', 'text-green-400');
            result.classList.add('bg-red-900/30', 'text-red-400', 'border', 'border-red-500/30');
        }
    })
    .catch(error => {
        console.log(error);
        result.innerHTML = "Network error. Please try again.";
        result.classList.remove('hidden');
        result.classList.add('bg-red-900/30', 'text-red-400');
    })
    .then(function() {
        // 6. æ¢å¤æŒ‰é’®
        btnText.innerText = originalText;
        btnIcon.classList.remove('hidden');
        btn.disabled = false;
        btn.classList.remove('opacity-50', 'cursor-not-allowed');
        
        // 5ç§’åè‡ªåŠ¨æ¶ˆå¤±æç¤ºï¼Œä¿æŒç•Œé¢å¹²å‡€
        setTimeout(() => {
            result.classList.add('hidden');
        }, 5000);
    });
  });
</script>